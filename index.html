<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>A Game of Surveys</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --bg:#0f1220; --accent:#7cf3c0; --danger:#ff6b6b; --text:#e9ecff;
}
body{
  margin:0; background:var(--bg); color:var(--text);
  font-family:system-ui,Segoe UI,Arial;
  overflow:hidden;
}
canvas{position:fixed; inset:0; z-index:-1}
#ui{position:fixed; inset:0; display:flex; justify-content:center}
.panel{
  margin-top:40px; max-width:760px; width:95%;
  background:rgba(255,255,255,.06);
  backdrop-filter:blur(10px);
  border-radius:20px; padding:24px;
}
button{
  background:linear-gradient(#8af3c8,#57d6a1);
  border:none; border-radius:12px;
  padding:10px 16px; font-weight:700; cursor:pointer;
  margin:4px;
}
textarea{
  width:100%; min-height:100px;
  background:#0e1230; color:var(--text);
  border-radius:12px; padding:12px;
}
.progress{
  height:10px; background:#22286b; border-radius:99px; overflow:hidden;
}
.progress div{
  height:100%; background:var(--accent); transition:.3s;
}
.money{
  font-size:36px; color:var(--accent); text-align:center;
}
.badge{
  padding:6px 12px; border-radius:99px;
  background:#22286b; font-size:13px;
}
.top{display:flex; justify-content:space-between; margin-bottom:10px}
.float{
  position:fixed; pointer-events:none;
  font-weight:900;
  animation:float 1.1s ease-out forwards;
}
.float.normal{font-size:28px; color:white}
.float.crit{font-size:44px; color:#ff4b4b}
@keyframes float{
  from{transform:translateY(0) scale(1); opacity:1}
  to{transform:translateY(-60px) scale(1.1); opacity:0}
}
</style>
</head>

<body>
<canvas id="bg"></canvas>
<div id="ui"></div>

<script>
/* ===== UTIL ===== */
const fmt=n=>{
  if(n>=1e9) return (n/1e9).toFixed(2)+"B";
  if(n>=1e6) return (n/1e6).toFixed(2)+"M";
  if(n>=1e3) return (n/1e3).toFixed(1)+"K";
  return Math.floor(n);
};

/* ===== PARTICLES ===== */
const canvas=document.getElementById("bg"),ctx=canvas.getContext("2d");
let W,H,particles=[];
function resize(){W=canvas.width=innerWidth;H=canvas.height=innerHeight}
addEventListener("resize",resize); resize();
for(let i=0;i<140;i++){
  particles.push({
    x:Math.random()*W,y:Math.random()*H,
    vx:(Math.random()-.5)*.3,vy:(Math.random()-.5)*.3,
    r:Math.random()*2+.5
  });
}
(function anim(){
  ctx.clearRect(0,0,W,H);
  particles.forEach(p=>{
    p.x+=p.vx; p.y+=p.vy;
    if(p.x<0||p.x>W)p.vx*=-1;
    if(p.y<0||p.y>H)p.vy*=-1;
    ctx.beginPath();
    ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
    ctx.fillStyle="rgba(124,243,192,.4)";
    ctx.fill();
  });
  requestAnimationFrame(anim);
})();

/* ===== QUESTIONS ===== */
const QUESTIONS=[
  "What motivates you to succeed?",
  "How do you handle failure?",
  "What does progress mean to you?",
  "What keeps you disciplined?",
  "How do you manage stress?",
  "What inspires you to learn?",
  "What does success look like?",
  "How do you stay focused?",
  "What is your biggest strength?",
  "What does teamwork mean to you?",
  "How do you handle pressure?",
  "What drives personal growth?",
  "What helps you stay organized?",
  "What does responsibility mean?",
  "What motivates long-term goals?",
  "What builds confidence?",
  "What makes work meaningful?",
  "What does balance mean to you?",
  "How do you adapt to change?",
  "What does leadership mean?"
];

/* ===== STATE ===== */
const ui=document.getElementById("ui");
let S=JSON.parse(localStorage.getItem("surveySave"))||{
  q:0,trickChance:5,inTrick:false,trick:null
};
function save(){localStorage.setItem("surveySave",JSON.stringify(S))}
function reset(){localStorage.removeItem("surveySave");location.reload()}
function panel(h){ui.innerHTML=`<div class="panel">${h}</div>`}

/* ===== MAIN ===== */
function render(){
  if(S.q>=QUESTIONS.length){
    panel(`<h1>ðŸŽ‰ Survey Complete</h1><button onclick=reset()>Restart</button>`);
    return;
  }
  if(S.inTrick) return renderTrick();

  panel(`
    <div class="top">
      <div class="badge">Question ${S.q+1}/20</div>
      <div class="badge">Trick Chance: ${S.trickChance}%</div>
    </div>
    <div class="progress"><div style="width:${(S.q/20)*100}%"></div></div>
    <p>${QUESTIONS[S.q]}</p>
    <textarea id="answer" placeholder="Type at least one wordâ€¦"></textarea>
    <br><br>
    <button onclick=submit()>Continue</button>
    <button onclick=reset()>Start Over</button>
  `);
  save();
}

function submit(){
  const v=document.getElementById("answer").value.trim();
  if(!v) return;
  S.q++;
  if(Math.random()*100<S.trickChance){
    S.inTrick=true; spawnTrick();
  }else S.trickChance+=1;
  render();
}

/* ===== TRICKS ===== */
function spawnTrick(){
  const r=Math.random();
  if(r<.2) S.trick={t:"letter"};
  else if(r<.4) S.trick={t:"image"};
  else if(r<.6) S.trick={t:"slider"};
  else initClicker();
}
function renderTrick(){
  const t=S.trick.t;
  if(t==="letter") panel(`<h3>Select D</h3>${["A","B","C","D"].map(l=>`<button onclick="l('${l}')">${l}</button>`).join("")}`);
  if(t==="image") panel(`<h3>What is this?</h3><img src="tomato.png" width=200><br>${["Tomato","Corn","Egg","Avocado"].map(o=>`<button onclick="img('${o}')">${o}</button>`).join("")}`);
  if(t==="slider") panel(`<h3>Slide to 7</h3><input type=range min=1 max=10 id=s><br><button onclick="sl()">Submit</button>`);
  if(t==="clicker") renderClicker();
}
function l(v){v==="D"?pass():reset()}
function img(v){v==="Tomato"?pass():reset()}
function sl(){document.getElementById("s").value==7?pass():reset()}
function pass(){S.inTrick=false;S.trickChance+=1;render();save()}

/* ===== CLICKER ===== */
let C;
function initClicker(){
  C={
    pts:0,ppc:1,
    crit:0.1,multi:2,
    critCost:5000,multiCost:1000,
    need:1_000_000
  };
  S.trick={t:"clicker"};
}

function renderClicker(){
  panel(`
    <h3>Clicker Challenge</h3>
    <div class="money">${fmt(C.pts)}</div>
    <div class="progress"><div style="width:${Math.min(100,(C.pts/C.need)*100)}%"></div></div>
    <p>PPC ${C.ppc} | Crit ${C.crit.toFixed(1)}% | x${C.multi.toFixed(1)}</p>
    <button id="clickBtn">CLICK</button>
    <hr>
    <button onclick=upPPC()>+1 PPC (100)</button>
    <button onclick=upCrit()>+1% Crit (${fmt(C.critCost)})</button>
    <button onclick=upMulti()>+0.1 Multi (${fmt(C.multiCost)})</button>
  `);
  document.getElementById("clickBtn").addEventListener("click",doClick);
}

function doClick(e){
  let gain=C.ppc;
  const crit=Math.random()*100<C.crit;
  if(crit) gain=Math.floor(gain*C.multi);
  C.pts+=gain;

  spawnFloat(e.clientX,e.clientY,crit?`CRIT!!! +${fmt(gain)}`:`+${fmt(gain)}`,crit);
  if(C.pts>=C.need) pass();
  renderClicker();
}

function spawnFloat(x,y,t,crit){
  const d=document.createElement("div");
  d.className="float "+(crit?"crit":"normal");
  d.style.left=x+"px"; d.style.top=y+"px";
  d.textContent=t;
  document.body.appendChild(d);
  setTimeout(()=>d.remove(),1100);
}

function upPPC(){if(C.pts>=100){C.pts-=100;C.ppc++;renderClicker()}}
function upCrit(){
  if(C.pts>=C.critCost && C.crit<10){
    C.pts-=C.critCost;
    C.crit=Math.min(10,C.crit+1);
    C.critCost*=1.2;
    renderClicker();
  }
}
function upMulti(){
  if(C.pts>=C.multiCost && C.multi<5){
    C.pts-=C.multiCost;
    C.multi=Math.min(5,C.multi+.1);
    C.multiCost*=1.4;
    renderClicker();
  }
}

/* ===== START ===== */
panel(`
<h1>A Game of Surveys</h1>
<button onclick=render()>Start</button>
${localStorage.getItem("surveySave")?'<button onclick=render()>Resume</button>':""}
`);
</script>
</body>
</html>
