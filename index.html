<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>A Game Of Surveys</title>

<style>
body{
  font-family: Arial, sans-serif;
  background:white;
  margin:0;
  padding:20px;
}
#top{
  display:flex;
  justify-content:space-between;
  margin-bottom:20px;
}
#progressBar{
  width:100%;
  height:14px;
  background:#ddd;
  border-radius:7px;
  overflow:hidden;
}
#progressFill{
  height:100%;
  width:0%;
  background:#4caf50;
}
.warning{
  color:red;
  font-weight:bold;
}
button{
  padding:10px 16px;
  font-size:16px;
  margin-top:10px;
}
textarea{
  width:100%;
  height:90px;
}
</style>
</head>

<body>

<div id="top">
  <div id="counter"></div>
  <div id="chance"></div>
</div>

<div id="progressBar">
  <div id="progressFill"></div>
</div>

<div id="container"></div>

<script>
/* ---------------- STATE ---------------- */

let state={
  level:0,
  step:0,
  trickChance:2
};

/* ---------------- QUESTIONS ---------------- */

const questions={
  1:[
    "What does success mean to you?",
    "What motivates you to work hard?",
    "Describe a goal you are proud of achieving.",
    "How do you handle failure?",
    "What skill would you like to improve?"
  ],
  2:[
    "What inspires you creatively?",
    "How do you stay focused?",
    "What is your biggest strength?",
    "What challenges you the most?",
    "How do you define happiness?",
    "What habits help you succeed?",
    "What does teamwork mean to you?",
    "How do you manage stress?",
    "What does leadership mean to you?",
    "What motivates long-term goals?",
    "How do you learn best?",
    "What is something you overcame?",
    "What makes a good decision?",
    "What does responsibility mean?",
    "How do you stay organized?",
    "What drives personal growth?",
    "What is meaningful work?",
    "What helps you stay disciplined?",
    "What does balance mean?",
    "What inspires improvement?"
  ],
  3:[
    "Describe a time you adapted to change.",
    "What motivates you during difficulty?",
    "How do you prioritize tasks?",
    "What does integrity mean?",
    "How do you solve problems?",
    "What makes feedback useful?",
    "How do you handle pressure?",
    "What defines success in a team?",
    "What does perseverance mean?",
    "How do you stay motivated?",
    "What makes communication effective?",
    "How do you learn from mistakes?",
    "What encourages innovation?",
    "How do you build confidence?",
    "What is constructive criticism?",
    "How do you improve consistency?",
    "What helps decision making?",
    "What motivates improvement?",
    "How do you measure progress?",
    "What builds resilience?",
    "How do you manage time?",
    "What does accountability mean?",
    "What creates strong habits?",
    "How do you handle setbacks?",
    "What inspires leadership?",
    "What does collaboration mean?",
    "How do you stay curious?",
    "What encourages learning?",
    "How do you maintain focus?",
    "What builds trust?",
    "What motivates excellence?",
    "How do you adapt strategies?",
    "What does commitment mean?",
    "How do you evaluate success?",
    "What supports growth?",
    "What encourages effort?",
    "How do you stay determined?",
    "What motivates progress?",
    "What does achievement mean?",
    "How do you refine skills?"
  ]
};

/* ---------------- GROWTH ---------------- */

function growthRate(){
  if(state.level===1) return 0.1;
  if(state.level===2) return 0.33;
  if(state.level===3) return 1;
  return 0;
}

/* ---------------- SAVE / LOAD ---------------- */

function save(){
  localStorage.setItem("surveySave",JSON.stringify(state));
}

function load(){
  const d=localStorage.getItem("surveySave");
  if(!d) return false;
  state=JSON.parse(d);
  return true;
}

/* ---------------- VALIDATION ---------------- */

function validText(t){
  if(!t) return false;
  const words=t.trim().split(/\s+/);
  if(words.length<5) return false;
  const unique=new Set(words.map(w=>w.toLowerCase()));
  return unique.size>=3;
}

/* ---------------- RENDER ---------------- */

function render(){
  const c=document.getElementById("container");
  c.innerHTML="";

  document.getElementById("counter").innerHTML=
    state.level>0 ? `Level ${state.level}` : "";

  document.getElementById("chance").innerHTML=
    state.level>0
      ? `Trick Chance: ${state.trickChance.toFixed(2)}%`
      : "";

  if(state.trickChance>=50){
    document.getElementById("chance").className="warning";
  }else{
    document.getElementById("chance").className="";
  }

  if(state.level===0){
    c.innerHTML=`
      <h2>A Game Of Surveys</h2>
      <p>This survey will take approximately 15 minutes.</p>
      <button onclick="startNew()">Start New</button>
      ${localStorage.getItem("surveySave")
        ? `<button onclick="resume()">Resume</button>`
        : ""
      }
    `;
    return;
  }

  renderQuestion();
}

/* ---------------- QUESTION RENDER ---------------- */

function renderQuestion(){
  const list=questions[state.level];
  if(!list || state.step>=list.length){
    nextLevel();
    return;
  }

  const total=list.length;
  const percent=(state.step/total)*100;
  document.getElementById("progressFill").style.width=percent+"%";

  document.getElementById("container").innerHTML=`
    <h3>${state.step+1}/${total}</h3>
    <p>${list[state.step]}</p>
    <textarea id="answer"></textarea>
    <br>
    <button onclick="submit()">Continue</button>
  `;
}

/* ---------------- SUBMIT ---------------- */

function submit(){
  const t=document.getElementById("answer").value;
  if(!validText(t)){
    alert("Your answer must be meaningful and related.");
    return;
  }

  state.step++;
  state.trickChance=Math.min(
    100,
    state.trickChance + growthRate()
  );

  save();
  render();
}

/* ---------------- LEVEL CHANGE ---------------- */

function nextLevel(){
  state.level++;
  state.step=0;

  if(state.level>3){
    document.getElementById("container").innerHTML=
      "<h2>Survey Complete</h2>";
    localStorage.removeItem("surveySave");
    return;
  }

  save();
  render();
}

/* ---------------- CONTROLS ---------------- */

function startNew(){
  state={level:1,step:0,trickChance:2};
  save();
  render();
}

function resume(){
  if(load()) render();
}

/* ---------------- START ---------------- */

window.onload=()=>{
  if(!load()) state.level=0;
  render();
};
</script>

</body>
</html>
