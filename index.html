<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>A Game Of Surveys</title>

<style>
body{font-family:Arial;margin:0;background:#fff}
#top{display:flex;justify-content:space-between;padding:15px}
#progressText{font-size:18px}
#progressBarOuter{width:320px;height:18px;background:#eee;border-radius:10px}
#progressBarInner{height:100%;width:0%;background:#4caf50}
#container{text-align:center;margin-top:80px}
.option{display:block;margin:8px auto}
button{padding:10px 20px;font-size:16px;margin:10px}
textarea{width:320px}
input[type=range]{width:300px}
img{max-width:200px;margin:15px 0}
</style>
</head>

<body>

<div id="top">
  <div>
    <div id="progressText"></div>
    <div id="progressBarOuter"><div id="progressBarInner"></div></div>
  </div>
  <div id="trick"></div>
</div>

<div id="container"></div>

<script>
/* ================= STATE ================= */
let level=0, step=0, trickChance=0, currentQuestion=null;

/* ================= STORAGE ================= */
function saveProgress(){
  localStorage.setItem("surveySave",JSON.stringify({level,step,trickChance}));
}
function clearProgress(){
  localStorage.removeItem("surveySave");
}
function loadProgress(){
  const s=localStorage.getItem("surveySave");
  if(!s) return false;
  try{
    const d=JSON.parse(s);
    level=d.level??0;
    step=d.step??0;
    trickChance=d.trickChance??0;
    return true;
  }catch{return false;}
}

/* ================= QUESTIONS ================= */
const level0=[
 {type:"radio",text:"What is your gender?",options:["Man","Woman"]},
 {type:"radio",text:"How old are you?",options:["Under 18","18-24","25-34","35-44","45-56","57-70","70+"]},
 {type:"radio",text:"What is your job?",options:["Engineer","Firefighter","College"]}
];

const level1=[
 {type:"text",text:"What is your masterâ€™s degree?"},
 {type:"text",text:"What made it good? (10+ words)"},
 ...Array.from({length:18},(_,i)=>({
   type:"radio",
   text:`Survey Question ${i+3}`,
   options:["A","B","C","D"]
 }))
];

const level2=Array.from({length:40},(_,i)=>(
 i===9
 ?{type:"slider",text:"Was it hard to achieve?",min:1,max:10}
 :{type:"text",text:`Mixing Question ${i+1}`}
));

const level4=Array.from({length:60},(_,i)=>({
 type:"text",text:`Final Survey Question ${i+1}`
}));

/* ================= GENERATOR ================= */
function generateQuestion(){
 const base=level===0?level0:level===1?level1:level===2?level2:level===4?level4:[];
 if(level>=1 && Math.random()*100<trickChance){

   // ðŸŽ® 10% CLICKER
   if(Math.random()<0.10){
     return{trick:true,type:"clicker",text:"Verification challenge: Reach 1,000,000 points to continue."};
   }

   // ðŸ–¼ï¸ 20% IMAGE
   if(Math.random()<0.20){
     return{
       trick:true,type:"image",
       text:"Image verification: What is shown?",
       image:"tomato.png",
       options:["Corn","Tomato","Egg","Avocado"],
       correct:"Tomato"
     };
   }

   // ðŸ”¤ / ðŸŽšï¸ OTHER
   if(Math.random()<0.5){
     const letters=["A","B","C","D"];
     const correct=letters[Math.floor(Math.random()*4)];
     return{trick:true,type:"radio",text:`This is a different question. Please select "${correct}".`,options:letters,correct};
   }else{
     const correct=Math.floor(Math.random()*10)+1;
     return{trick:true,type:"slider",text:`Verification check. Slide to ${correct}.`,min:1,max:10,correct};
   }
 }
 return base[step]||null;
}

/* ================= RENDER ================= */
function render(){
 const total=level===1?20:level===2?40:level===4?60:0;
 const percent=total?Math.round(step/total*100):0;

 progressText.innerText=total?`${percent}% Complete`:"";
 progressBarInner.style.width=total?`${percent}%`:"0%";
 trick.innerText=level>=1?`Trick Question Chance: ${trickChance.toFixed(2)}%`:"";

 if(total && step>=total){
   container.innerHTML=`<h2>Level ${level} Complete</h2>
   <button onclick="nextLevel()">Continue</button>`;
   return;
 }

 currentQuestion=generateQuestion();
 if(!currentQuestion){
   container.innerHTML=`<h2>Ready for Level ${level+1}</h2>
   <button onclick="nextLevel()">Continue</button>`;
   return;
 }

 /* ðŸŽ® CLICKER */
 if(currentQuestion.type==="clicker"){
   let score=+localStorage.getItem("clickerScore")||0;
   let power=+localStorage.getItem("clickerPower")||1;
   container.innerHTML=`
     <h2>${currentQuestion.text}</h2>
     <h3>Score: ${score.toLocaleString()}</h3>
     <button onclick="clickerClick()">Click Me</button><br><br>
     <button onclick="buyUpgrade(1,1000)">+1 / click (1k)</button>
     <button onclick="buyUpgrade(10,10000)">+10 / click (10k)</button>
     <button onclick="buyUpgrade(100,100000)">+100 / click (100k)</button>
   `;
   if(score>=1000000){
     container.innerHTML+=`<br><button onclick="finishClicker()">Continue Survey</button>`;
   }
   return;
 }

 container.innerHTML=`<h2>${currentQuestion.text}</h2>`;

 if(currentQuestion.type==="image"){
   container.innerHTML+=`<img src="${currentQuestion.image}">`;
 }

 if(currentQuestion.type==="radio"||currentQuestion.type==="image"){
   currentQuestion.options.forEach(o=>{
     container.innerHTML+=`
     <label class="option">
       <input type="radio" name="q" value="${o}"> ${o}
     </label>`;
   });
 }

 if(currentQuestion.type==="text"){
   container.innerHTML+=`<textarea id="txt" rows="4"></textarea>`;
 }

 if(currentQuestion.type==="slider"){
   container.innerHTML+=`<br><input type="range" id="rng"
   min="${currentQuestion.min}" max="${currentQuestion.max}">`;
 }

 container.innerHTML+=`<br><button onclick="next()">Continue</button>`;
}

/* ================= ACTIONS ================= */
function next(){
 let val=null;
 if(currentQuestion.type==="radio"||currentQuestion.type==="image"){
   const r=document.querySelector("input[name=q]:checked");
   if(!r)return alert("Select an option");
   val=r.value;
 }
 if(currentQuestion.type==="text"){
   val=document.getElementById("txt").value.trim();
   if(val.length<5||val.split(/\s+/).length<3)return disqualify();
 }
 if(currentQuestion.type==="slider"){
   val=+document.getElementById("rng").value;
 }
 if(currentQuestion.trick&&val!==currentQuestion.correct)return disqualify();

 step++;
 if(level===1)trickChance+=0.01;
 if(level===2)trickChance+=0.25;
 if(level===4)trickChance+=1;

 saveProgress();
 render();
}

function nextLevel(){
 level++;
 step=0;
 trickChance=level===1?2:0;
 saveProgress();
 render();
}

/* ðŸŽ® CLICKER FUNCTIONS */
function clickerClick(){
 let s=+localStorage.getItem("clickerScore")||0;
 let p=+localStorage.getItem("clickerPower")||1;
 s+=p;
 localStorage.setItem("clickerScore",s);
 render();
}
function buyUpgrade(a,c){
 let s=+localStorage.getItem("clickerScore")||0;
 let p=+localStorage.getItem("clickerPower")||1;
 if(s<c)return;
 localStorage.setItem("clickerScore",s-c);
 localStorage.setItem("clickerPower",p+a);
 render();
}
function finishClicker(){
 localStorage.removeItem("clickerScore");
 localStorage.removeItem("clickerPower");
 step++;
 saveProgress();
 render();
}

function disqualify(){
 clearProgress();
 document.body.innerHTML="<h1>You were disqualified.</h1>";
}

/* ================= START ================= */
if(loadProgress()){
 container.innerHTML=`
   <h2>Resume your survey?</h2>
   <button onclick="render()">Resume</button>
   <button onclick="clearProgress();location.reload()">Start Over</button>`;
}else{
 render();
}
</script>
</body>
</html>
